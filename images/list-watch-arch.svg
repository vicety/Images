<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1707px" height="925px" viewBox="-0.5 -0.5 1707 925"><defs><clipPath id="mx-clip-4-31-502-174-0"><rect x="4" y="31" width="502" height="174"/></clipPath><clipPath id="mx-clip-4-213-502-122-0"><rect x="4" y="213" width="502" height="122"/></clipPath><clipPath id="mx-clip-563-36-602-166-0"><rect x="563" y="36" width="602" height="166"/></clipPath><clipPath id="mx-clip-563-210-602-52-0"><rect x="563" y="210" width="602" height="52"/></clipPath><clipPath id="mx-clip-577-506-291-74-0"><rect x="577" y="506" width="291" height="74"/></clipPath><clipPath id="mx-clip-577-588-291-52-0"><rect x="577" y="588" width="291" height="52"/></clipPath><clipPath id="mx-clip-997-320-296-74-0"><rect x="997" y="320" width="296" height="74"/></clipPath><clipPath id="mx-clip-997-402-296-103-0"><rect x="997" y="402" width="296" height="103"/></clipPath><clipPath id="mx-clip-585-321-252-24-0"><rect x="585" y="321" width="252" height="24"/></clipPath><clipPath id="mx-clip-585-353-252-50-0"><rect x="585" y="353" width="252" height="50"/></clipPath><clipPath id="mx-clip-993-582-292-101-0"><rect x="993" y="582" width="292" height="101"/></clipPath><clipPath id="mx-clip-993-691-292-29-0"><rect x="993" y="691" width="292" height="29"/></clipPath><clipPath id="mx-clip-1296-81-216-74-0"><rect x="1296" y="81" width="216" height="74"/></clipPath><clipPath id="mx-clip-1296-163-216-26-0"><rect x="1296" y="163" width="216" height="26"/></clipPath><clipPath id="mx-clip-1396-452-305-70-0"><rect x="1396" y="452" width="305" height="70"/></clipPath><clipPath id="mx-clip-1396-530-305-50-0"><rect x="1396" y="530" width="305" height="50"/></clipPath></defs><g><path d="M 0 26 L 0 0 L 510 0 L 510 26" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 0 26 L 0 330 L 510 330 L 510 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 0 26 L 510 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="254.5" y="17.5">sharedInformerFactory</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-4-31-502-174-0)" font-size="12px"><text x="5.5" y="43.5">对应一个client/operator，维护单例的informer集合、</text><text x="5.5" y="57.5">提供gvk形式的、便利的informer创建方式（指factory.Core().V1().ConfigMaps().Informer()）</text><text x="5.5" y="71.5">start函数会run其管理的所有informer</text><text x="5.5" y="99.5">成员：</text><text x="5.5" y="113.5">client 由代码生成得到，包含对资源的Get、Create、List|、Watch等等操作</text><text x="5.5" y="127.5">namespace：要监控的namespace，影响到client发送的请求体</text><text x="5.5" y="141.5">defaultResync: 多久对deltaFIFO中的所有item调用一次handler的updateFunc</text><text x="5.5" y="155.5">informers：informer map，k为资源类型，v为informer</text><text x="5.5" y="169.5">startedInformers：已经启动的informer</text><text x="5.5" y="183.5">customResync：对不同informer不同的resync时间</text></g><path d="M 0 204 L 510 204" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-4-213-502-122-0)" font-size="12px"><text x="5.5" y="225.5">成员函数通过代码生成得到，经典用法如factory.Core().V1().ConfigMaps().Informer()，</text><text x="5.5" y="239.5">通过builder模式向factory注册了一个单例的configMap的informer</text><text x="5.5" y="267.5">Start() run管理的所有infromer</text><text x="5.5" y="281.5">InformerFor() 根据struct类型获得或者创建（如果不存在）informer</text></g><path d="M 559 31 L 559 5 L 1169 5 L 1169 31" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 559 31 L 559 257 L 1169 257 L 1169 31" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 559 31 L 1169 31" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="863.5" y="22.5">sharedIndexInformer</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-563-36-602-166-0)" font-size="12px"><text x="564.5" y="48.5">即informerFactory中的informer，用于对一种对象的list&amp;watch</text><text x="564.5" y="62.5">数据流：list&amp;watch -&gt; queue -&gt; distribute to multiple listeners -&gt; listeners call there handle func</text><text x="564.5" y="90.5">成员：</text><text x="564.5" y="104.5">indexer 是一个map[string][string][string set]的map，从etcd watch到的最新资源状态在本地的缓存</text><text x="564.5" y="118.5">controller 含有Run和HasSynced方法，负责做list&amp;watch，并将数据传给一个队列（DeltaFIFO）</text><text x="564.5" y="132.5">sharedProcessor 维护资源变化事件的订阅者</text><text x="564.5" y="146.5">listerwatcher 包含list和watch func，两个函数指针，用户可配</text><text x="564.5" y="160.5">objectType 此informer关心的对象类型</text><text x="564.5" y="174.5">started informer状态</text><text x="564.5" y="188.5">stopped informer状态</text></g><path d="M 559 201 L 1169 201" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-563-210-602-52-0)" font-size="12px"><text x="564.5" y="222.5">AddEventHandler() 将事件处理的handlerFunc(onAdd/Update/Delete)包装为listener注册到sharedIndexInformer中</text><text x="564.5" y="236.5">Run() 即sharedProcessor.run + controller.run</text><text x="564.5" y="250.5">HasSynced() </text></g><path d="M 722.5 475 L 722.46 436.46 L 722.01 404.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721.94 399.12 L 725.53 406.07 L 722.01 404.37 L 718.53 406.17 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 573 501 L 573 475 L 872 475 L 872 501" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 573 501 L 573 635 L 872 635 L 872 501" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 573 501 L 872 501" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="722" y="492.5">processorListener</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-577-506-291-74-0)" font-size="12px"><text x="578.5" y="518.5">数据流：addCh -&gt; ringBuffer -&gt; nextCh -&gt; handleFunc</text><text x="578.5" y="546.5">nextCh</text><text x="578.5" y="560.5">addCh</text><text x="578.5" y="574.5">handler 包括OnAdd、OnUpdate、OnDelete</text></g><path d="M 573 579 L 872 579" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-577-588-291-52-0)" font-size="12px"><text x="578.5" y="600.5">add 向addCh添加obj</text><text x="578.5" y="614.5">pop 启动addCh -&gt; ringBuffer -&gt; nextCh部分</text><text x="578.5" y="628.5">run 启动nextCh -&gt; handle func部分</text></g><path d="M 1145 289 L 1145.08 269.08 L 1080.46 269.08 L 1080.5 263.52" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1080.54 258.27 L 1083.99 265.3 L 1080.5 263.52 L 1076.99 265.25 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 993 315 L 993 289 L 1297 289 L 1297 315" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 993 315 L 993 500 L 1297 500 L 1297 315" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 993 315 L 1297 315" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1144.5" y="306.5">controller</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-997-320-296-74-0)" font-size="12px"><text x="998.5" y="332.5">reflector 负责执行list&amp;watch并发送给队列（DeltaFIFO)</text><text x="998.5" y="346.5">ProcessFunc 初始化时写死，见下方processloop函数</text><text x="998.5" y="360.5">ObjectType 关心的资源类型</text></g><path d="M 993 393 L 1297 393" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-997-402-296-103-0)" font-size="12px"><text x="998.5" y="414.5">run 调用reflector.run和自身的processloop</text><text x="998.5" y="428.5">processloop 不断从controller.config.Queue中取obj，</text><text x="998.5" y="442.5">调用sharedIndexInformer中初始化controller时写死的</text><text x="998.5" y="456.5">handleDelta函数，此函数将obj更新到</text><text x="998.5" y="470.5">本地cache(indexer)，同时将obj发布到</text><text x="998.5" y="484.5">s.processor.listeners中(s.processor.distribute)</text></g><path d="M 711 290 L 721.23 290 L 721.25 263.52" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721.26 258.27 L 724.75 265.28 L 721.25 263.52 L 717.75 265.27 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 581 316 L 581 290 L 841 290 L 841 316" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 581 316 L 581 398 L 841 398 L 841 316" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 581 316 L 841 316" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="710.5" y="307.5">sharedProcessor</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-585-321-252-24-0)" font-size="12px"><text x="586.5" y="333.5">listeners 管理多个监听同一对象的listener</text></g><path d="M 581 344 L 841 344" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-585-353-252-50-0)" font-size="12px"><text x="586.5" y="365.5">addListener 注册订阅者</text><text x="586.5" y="379.5">distribute 将obj送到每个listener</text><text x="586.5" y="393.5">run 对所有listener调用pop+run</text></g><path d="M 1292 113 L 1230.46 113.08 L 1175.37 113.9" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1170.12 113.98 L 1177.06 110.38 L 1175.37 113.9 L 1177.17 117.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1139 551 L 1139.08 525.54 L 1138.96 505.34" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1138.93 500.09 L 1142.47 507.07 L 1138.96 505.34 L 1135.47 507.11 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 989 577 L 989 551 L 1289 551 L 1289 577" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 989 577 L 989 715 L 1289 715 L 1289 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 989 577 L 1289 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1138.5" y="568.5">reflector</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-993-582-292-101-0)" font-size="12px"><text x="994.5" y="594.5">listerWatcher list和watch方法实现，两个函数指针</text><text x="994.5" y="608.5">store 用来存储watch到的资源，</text><text x="994.5" y="622.5">实现类是个队列（DeltaFIFO)</text><text x="994.5" y="636.5">resyncPeriod 定期将cache中所有元素拿出，</text><text x="994.5" y="650.5">作为update事件enqueue到队列中，</text><text x="994.5" y="664.5">相当于定期触发事件，很少用到的功能</text></g><path d="M 989 682 L 1289 682" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-993-691-292-29-0)" font-size="12px"><text x="994.5" y="703.5">run 执行list&amp;watch</text></g><path d="M 559 114 L 534.46 114 L 516.36 113.32" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 511.12 113.12 L 518.24 109.89 L 516.36 113.32 L 517.98 116.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1292 76 L 1292 50 L 1516 50 L 1516 76" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1292 76 L 1292 184 L 1516 184 L 1516 76" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1292 76 L 1516 76" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1403.5" y="67.5">cache</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1296-81-216-74-0)" font-size="12px"><text x="1297.5" y="93.5">用于存储watch到的资源的最新状态</text><text x="1297.5" y="107.5">cacheStorage ThreadSafeStore</text><text x="1297.5" y="121.5">keyFunc KeyFunc</text></g><path d="M 1292 154 L 1516 154" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1296-163-216-26-0)" font-size="12px"><text x="1297.5" y="175.5">+ method(type): type</text></g><path d="M 1392 447 L 1392 421 L 1705 421 L 1705 447" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1392 447 L 1392 575 L 1705 575 L 1705 447" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1392 447 L 1705 447" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1548" y="438.5">DeltaFIFO</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1396-452-305-70-0)" font-size="12px"><text x="1397.5" y="464.5">items map[string]Deltas map[key] -&gt; deltas 用于O(1)访问</text><text x="1397.5" y="478.5">queue []string 存储key set</text><text x="1397.5" y="492.5">knownObjects 就是sharedIndexInformer的cache，</text><text x="1397.5" y="506.5">本地缓存</text></g><path d="M 1392 521 L 1705 521" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1396-530-305-50-0)" font-size="12px"><text x="1397.5" y="542.5">常见的队列操作</text><text x="1397.5" y="556.5">AddAfter 支持延迟一定时间后入队</text></g><path d="M 1392 482 L 1340.46 482 L 1340.46 627.54 L 1295.37 627.54" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1290.12 627.54 L 1297.12 624.04 L 1295.37 627.54 L 1297.12 631.04 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1399.74 184.16 L 1545.11 415.61" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1547.91 420.05 L 1541.22 415.99 L 1545.11 415.61 L 1547.15 412.26 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 993 448.5 L 875.83 603.92" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 872.67 608.11 L 874.09 600.41 L 875.83 603.92 L 879.68 604.62 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 522px; margin-left: 935px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; background-color: #ffffff; white-space: nowrap; ">distribute到<br />所有listener<br />的addCh</div></div></div></foreignObject><text x="935" y="526" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">distribute到...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 915px; margin-left: 615px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; "><span style="color: rgb(111 , 175 , 189) ; background-color: rgb(43 , 43 , 43) ; font-family: &quot;jetbrains mono&quot; , monospace ; font-size: 9.8pt"><br /></span></div></div></div></foreignObject><text x="615" y="919" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="636" y="674" width="344" height="198" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 658px; margin-left: 720px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; background-color: #ffffff; white-space: nowrap; "><span style="font-size: 12px">根据事件类型，调用不同类型的处理函数</span></div></div></div></foreignObject><text x="720" y="661" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">根据事件类型，调用不同类型的处理函数</text></switch></g><path d="M 722 746 L 722 766.46 L 721.68 780.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721.56 785.88 L 718.22 778.81 L 721.68 780.63 L 725.22 778.96 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="648" y="686" width="148" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 146px; height: 1px; padding-top: 716px; margin-left: 649px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">AddFunc(obj)<br />UpdateFunc(old, new)<br />DeleteFunc(obj)</div></div></div></foreignObject><text x="722" y="720" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">AddFunc(obj)...</text></switch></g><path d="M 785 817 L 805.08 817.08 L 803.08 817.08 L 816.63 817.08" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 821.88 817.08 L 814.88 820.58 L 816.63 817.08 L 814.88 813.58 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="658" y="787" width="127" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 125px; height: 1px; padding-top: 817px; margin-left: 659px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">RateLimitedQueue</div></div></div></foreignObject><text x="722" y="821" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RateLimitedQueue</text></switch></g><rect x="823" y="787" width="148" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 146px; height: 1px; padding-top: 817px; margin-left: 824px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">用户业务逻辑<br />operator / 接入其他系统</div></div></div></foreignObject><text x="897" y="821" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">用户业务逻辑&#xa;operator / 接入其他系统</text></switch></g><path d="M 721.6 637.76 L 721.95 679.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721.99 684.88 L 718.43 677.91 L 721.95 679.63 L 725.43 677.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 74px; height: 1px; padding-top: 698px; margin-left: 877px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">用户逻辑</div></div></div></foreignObject><text x="914" y="702" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">用户逻辑</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>